Chronikos Database Schema Description
Authentication: Uses Supabase Auth with auth.users table containing user accounts.

user_profiles: User preferences and settings

user_id (UUID, FK to auth.users)
experience_level (beginner/intermediate/advanced/expert)
preferred_fact_length (short/medium/long)
daily_notification_enabled (boolean)
notification_time (time)
timezone (string)
push_subscription (JSONB) - web push subscription keys or null
last_notification_sent_at (timestamp) - time when last push notification was sent
interest_categories: Historical topic categories (20 predefined categories)

id (serial primary key)
name (string) - e.g., "Ancient History", "World Wars", "Science & Technology"
description (text)
user_interests: Many-to-many relationship between users and their historical interests

user_id (UUID, FK to auth.users)
category_id (int, FK to interest_categories)
interest_level (1-5 scale, how interested they are in this category)
user_onboarding_responses: Flexible storage for user onboarding questionnaire answers

user_id (UUID, FK to auth.users)
response_data (JSONB) - all user answers in flexible JSON structure including time periods, topics, experience level, learning motivations, historical figures, regional interests, interest scales, and open-ended text responses
completed_at (timestamp)
version (string) - onboarding version tracking
user_interest_analysis: AI analysis of onboarding responses to derive structured interests

user_id (UUID, FK to auth.users)
onboarding_response_id (UUID, FK to user_onboarding_responses)
analysis_prompt (text) - prompt sent to AI for analysis
ai_response (text) - full AI response with reasoning
derived_interests (JSONB) - structured data mapping to interest_categories with confidence levels
confidence_score (decimal 0.00-1.00) - AI confidence in the analysis
ai_model (string) - which AI model performed the analysis
is_applied (boolean) - whether these interests have been applied to user_interests table
daily_facts: Historical facts generated by LLM for each date

fact_date (date, unique) - one fact per day globally
fact_content (text) - the actual historical fact
fact_heading (text) - the title of the fact
source_prompt (text) - prompt sent to LLM
llm_model (string) - which LLM was used
category_id (int, FK to interest_categories)
difficulty_level (beginner/intermediate/advanced/expert)
fact_length (short/medium/long)
is_verified (boolean) - manual fact verification
user_daily_facts: Tracks fact delivery and user interactions

user_id (UUID, FK to auth.users)
daily_fact_id (int, FK to daily_facts)
delivered_at (timestamp)
is_read (boolean)
read_at (timestamp)
rating (1-5 scale, user rating of the fact)
is_bookmarked (boolean)
fact_generation_log: Tracks LLM fact generation process

generation_date (date)
status (pending/success/failed/retrying)
llm_api_calls (int) - number of API calls made
error_message (text)
execution_time_ms (int)
Key Relationships & Workflow:

Users complete onboarding questionnaire → stored in user_onboarding_responses as flexible JSONB
AI analyzes responses → creates user_interest_analysis with reasoning and confidence scores
Derived interests applied to user_interests table for structured categorization
One global fact per day in daily_facts → personalized delivery via user_daily_facts
Facts categorized by topic, difficulty, and length for user personalization
User engagement tracked (read, rated, bookmarked) for future improvements
